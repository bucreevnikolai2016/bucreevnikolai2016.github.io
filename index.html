<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="contact form example">
  <title>Оболочка</title>
</head>

<button id="myButton2" type="button">Админ мод</button>   
<button id="myButton3" type="button">Пользователь мод</button>    
    
<input id="myinput" name="myinput" value=""/>    
    
    
<video id="vid" controls="controls">
  <source src="http://bytopia.stream.voidboost.cc/6/9/4/6/9/8ffc7480e5c87899ba9d52cd63f58ad1:2022060608:f25500b6-a34a-4d35-93b4-871edb2b72ee/jd579.mp4" />
</video>  

<div style="display:none" id="json">json here</div>
<script type="text/javascript">
    setInterval(function() { 
       var id = '1-RhP13Sji4kCRqdVfXDQjj1YBw2-P9MwfLqHcYe-8Ic';
var gid = '0';
var url = 'https://docs.google.com/spreadsheets/d/'+id+'/gviz/tq?tqx=out:json&tq&gid='+gid;
fetch(url)
  .then(response => response.text())
  .then(data => document.getElementById("json").innerHTML=myItems(data.slice(47, -2))  
  );
function myItems(jsonString){
  var json = JSON.parse(jsonString);
  var table = '<table><tr>'
  json.table.cols.forEach(colonne => table += '<th>' + colonne.label + '</th>')
  table += '</tr>'
  json.table.rows.forEach(ligne => {
    table += '<tr>'
    ligne.c.forEach(cellule => {
        try{var valeur = cellule.f ? cellule.f : cellule.v}
        catch(e){var valeur = ''}
        table += '<td>' + valeur + '</td>'
      }
    )
    table += '</tr>'
    }
  )
  table += '</table>'
  return table
}
      }, 300);
    </script>       
    
    
  
    
 
   <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css">
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
   <!-- Style The Contact Form How Ever You Prefer -->
   <link rel="stylesheet" href="style.css">

  <form style="display:none" class="gform pure-form pure-form-stacked" method="POST" data-email="example@email.net"
  action="https://script.google.com/macros/s/AKfycbxwIw2e9kbYpJPeVykLVeITE9t5DtetnaMZsCKGk9x6UZyzD1ns1rR-FYKsPcQ4w_f3/exec">
    <!-- change the form action to your script url -->

    <div id="mydiv" class="form-elements">
      <fieldset class="pure-group">
      <label for="name">Name: </label>
      <input id="name" name="name" placeholder="What your Mom calls you" />
      </fieldset>
      <fieldset class="pure-group">
      <label for="color">Favourite Color: </label>
      <input id="color" name="color" placeholder="green" />
      </fieldset>

      <button id="myButton" class="button-success pure-button button-xlarge">
        <i class="fa fa-paper-plane"></i>&nbsp;Send</button>
    </div>

    </form>
        
<script data-cfasync="false" src="form-submission-handler.js"></script>          
    
<script type="text/javascript">
    setInterval(function() {     
    document.getElementById("mydiv").style="";
    document.getElementById('myButton').disabled = false;
      }, 300);
    </script>  

<script type="text/javascript">
  window.onload = init;
  function init(){
  var button2 = document.getElementById("myButton2")
  button2.onclick = handleButtonClick2;
  }
  function handleButtonClick2() {
  setInterval(function() {   
  if (vid.paused) {
  document.getElementById('color').value = '333';
  document.getElementById('name').value = vid.currentTime;
  myButton.click();
  setTimeout(() => { window.stop(); }, 4500);
} else {
  document.getElementById('color').value = '444';
  document.getElementById('name').value = vid.currentTime;
  myButton.click();
  setTimeout(() => { window.stop(); }, 4500);
}
          }, 5000);
  }
    </script>
    
    
<script type="text/javascript">
  var button3 = document.getElementById("myButton3")
  button3.onclick = handleButtonClick3;
  function handleButtonClick3() {
  setInterval(function() {
  var p1 = json.firstElementChild;
  var p2 = p1.firstElementChild;
  var p3 = p2.lastElementChild;
  var p4 = p3.lastElementChild;
  var p5 = p4.innerHTML;
  var p6=p4.previousElementSibling;
  var p7=p6.previousElementSibling;
  var p8=p7.previousElementSibling;
  var p9 = p8.innerHTML;
  if (p5 == 333) {
  vid.pause();
} 
  if (p5 == 444) {
  vid.play();
}
          }, 300);
  }
    </script>    
    
    

<script type="text/javascript">
setInterval(function() {
var xxx = json.firstElementChild;
var vvv = xxx.firstElementChild;
var bbb = vvv.lastElementChild;
var zzz = bbb.lastElementChild;
var sss = zzz.innerHTML;
document.getElementById('myinput').value = sss;
}, 300);
</script>
  
    
</html>
