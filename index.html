<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="contact form example">
  <title>Оболочка</title>
</head>
    
    
<button id="myButton2" type="button">Админ мод</button>   
<button id="myButton3" type="button">Пользователь мод (ПП)</button> 
<button id="myButton4" type="button">Пользователь мод (ПЕР)</button>  
    
<input id="myinput" name="myinput" value=""/>    
<input id="otpravka" name="otpravka" value=""/>   
<input id="emylast" name="emylast" value=""/>  
<input id="timeotp" name="timeotp" value="0"/>  
<input id="per" name="per" value="0"/> 
    
<video id="vid" controls="controls">
  <source src="https://olympus.stream.voidboost.cc/6/2/2/5/5/0c793fa6c8182a1cbb21d84f47eaeb9e:2022061305:YjFNM1NTTHArWGd5R0NnTktTa2pQNmxTaXNKVk9FeDhOMk1MQU9aaXVCOE51Rk1lS3FINFNYdy94TXQvSG01MjFhSTJ6VjZNaHBlYVRpZU85UU05N1E9PQ==/tsxud.mp4" />
</video>        
    
    
<div id="json2">json here</div>
<script type="text/javascript">
    setInterval(function() { 
       var id = '1VwEb0wFPn0GhpjNK8jAq7NzcyHUNLM1ht7r31lZ36F4';
var gid = '0';
var url = 'https://docs.google.com/spreadsheets/d/'+id+'/gviz/tq?tqx=out:json&tq&gid='+gid;
fetch(url)
  .then(response => response.text())
  .then(data => document.getElementById("json2").innerHTML=myItems(data.slice(47, -2))  
  );
function myItems(jsonString){
  var json = JSON.parse(jsonString);
  var table = '<table><tr>'
  json.table.cols.forEach(colonne => table += '<th>' + colonne.label + '</th>')
  table += '</tr>'
  json.table.rows.forEach(ligne => {
    table += '<tr>'
    ligne.c.forEach(cellule => {
        try{var valeur = cellule.f ? cellule.f : cellule.v}
        catch(e){var valeur = ''}
        table += '<td>' + valeur + '</td>'
      }
    )
    table += '</tr>'
    }
  )
  table += '</table>'
  return table
}
      }, 300);
    </script>       
 
<script type="text/javascript">    
  window.onload = init;
  function init(){
  var button2 = document.getElementById("myButton2")
  var button3 = document.getElementById("myButton3")
  var button4 = document.getElementById("myButton4")
  button2.onclick = handleButtonClick2;
  button3.onclick = handleButtonClick3;
  button4.onclick = handleButtonClick4;
  }
    </script>
  
<script type="text/javascript">
setInterval(function() { 
function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}
async function delayedGreeting() {
  var t1 = vid.currentTime;
  await sleep(50);
  var t2 = vid.currentTime;
  var t3 = t1 - t2;
  var t4 = Math.abs(t3);
  if (t4 > 1) {document.getElementById('per').value = '1';};
}
delayedGreeting();
}, 50);
</script> 
	
	
<script type="text/javascript">
function handleButtonClick2() {
setInterval(function() {   
var t7 = vid.currentTime;
var t9 = t7 + 1.5;
var t8 = document.getElementById('emylast').value;
if (vid.paused) {
var t6 = '333';
} else {
var t6 = '444';
}
if (document.getElementById('per').value == 0 || t8 == t6) {
if (document.getElementById('otpravka').value == 1) {
document.getElementById('otpravka').value = '0';
} else {
}
} else {
if (document.getElementById('otpravka').value == 1) {
} else {
if (document.getElementById('timeotp').value == 0) {
fetch("https://script.google.com/macros/s/AKfycbw2Lc_7vQfP6hiJLaNocWzqcMWXBtnG38S5xCHqUzyHu8XXhp98tP0w2EKMznGt9pbpzw/exec"+ "?" + "p1=" + t7 + "&p2=" + t6,
    { 
	method: "GET", 
	headers:{"content-type":"application/x-www-form-urlencoded"} 
	})
} else {
setTimeout(() => { fetch("https://script.google.com/macros/s/AKfycbw2Lc_7vQfP6hiJLaNocWzqcMWXBtnG38S5xCHqUzyHu8XXhp98tP0w2EKMznGt9pbpzw/exec"+ "?" + "p1=" + t9 + "&p2=" + t6, { method: "GET", headers:{"content-type":"application/x-www-form-urlencoded"} }) }, 1500);
}
document.getElementById('otpravka').value = '1';
document.getElementById('emylast').value = t6;
document.getElementById('per').value = '0'
document.getElementById('timeotp').value = '1';
setTimeout(() => { document.getElementById('timeotp').value = '0'; }, 1500);
}
}
}, 10);
}
</script>

    
    
<script type="text/javascript">
  function handleButtonClick3() {
  setInterval(function() {
  var p1 = json2.firstElementChild;
  var p2 = p1.firstElementChild;
  var p3 = p2.lastElementChild;
  var p4 = p3.lastElementChild;
  var p5 = p4.innerHTML;
  var p6=p4.previousElementSibling;
  var p9 = p6.innerHTML;
var g1 = p3.previousElementSibling;
var g2 = g1.lastElementChild;
var g3 = g2.innerHTML;
var g4 = g2.previousElementSibling;
var g5 = g4.innerHTML;
var y1 = p9 - g5;
var y2 = Math.abs(y1);
if (y2 < 1) {
if (g5 > p9) {
var p9 = g5;
var p5 = g3;
}
}
  if (vid.paused) {
  var p10 = '333';
  } else {
  var p10 = '444';
  }
  if (p10 == p5) {
  } else {
  if (p5 == 333) {
  vid.pause();
  vid.currentTime = p9;
  } 
  if (p5 == 444) {
  vid.play();
  vid.currentTime = p9;
  }
  }
          }, 10);
  }
    </script>    
    
<script type="text/javascript">
setInterval(function() {
var xxx = json2.firstElementChild;
var vvv = xxx.firstElementChild;
var bbb = vvv.lastElementChild;
var zzz = bbb.lastElementChild;
var sss = zzz.innerHTML;
document.getElementById('myinput').value = sss;
}, 1000);
</script>
  
    
</html>
